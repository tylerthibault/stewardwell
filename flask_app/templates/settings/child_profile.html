{% extends "base.html" %}

{% block title %}My Profile{% endblock %}

{% block authenticated_content %}
<div class="content-container">
    <div class="page-header">
        <h1>My Profile</h1>
        <p class="text-muted">Customize your profile and security settings</p>
    </div>

    <div class="row">
        <!-- Avatar Settings -->
        <div class="col-md-6 mb-4">
            <div class="card">
                <div class="card-header">
                    <h3>My Avatar</h3>
                </div>
                <div class="card-body">
                    <div class="text-center mb-4">
                        <div class="current-avatar mb-3">
                            <i class="fas {{ current_user.avatar|default('fa-user-circle') }} fa-5x"></i>
                        </div>
                    </div>
                    <form action="{{ url_for('settings.update_avatar') }}" method="POST">
                        <div class="avatar-grid">
                            {% for avatar in avatars %}
                            <div class="avatar-option">
                                <input type="radio" name="avatar" id="avatar_{{ avatar.id }}" 
                                       value="{{ avatar.icon }}" 
                                       {% if current_user.avatar == avatar.icon %}checked{% endif %}
                                       class="avatar-radio">
                                <label for="avatar_{{ avatar.id }}" class="avatar-label">
                                    <i class="fas {{ avatar.icon }} fa-2x"></i>
                                </label>
                            </div>
                            {% endfor %}
                        </div>
                        <button type="submit" class="btn btn-primary w-100 mt-3">
                            Update Avatar
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <!-- PIN Settings -->
        <div class="col-md-6 mb-4">
            <div class="card">
                <div class="card-header">
                    <h3>Change PIN</h3>
                </div>
                <div class="card-body">
                    <form action="{{ url_for('settings.update_pin') }}" method="POST">
                        <div class="mb-3">
                            <label for="current_pin" class="form-label">Current PIN</label>
                            <input type="password" class="form-control" id="current_pin" 
                                   name="current_pin" required pattern="[0-9]{4}" maxlength="4"
                                   inputmode="numeric">
                        </div>
                        <div class="mb-3">
                            <label for="new_pin" class="form-label">New PIN</label>
                            <input type="password" class="form-control" id="new_pin" 
                                   name="new_pin" required pattern="[0-9]{4}" maxlength="4"
                                   inputmode="numeric">
                        </div>
                        <div class="mb-3">
                            <label for="confirm_pin" class="form-label">Confirm New PIN</label>
                            <input type="password" class="form-control" id="confirm_pin" 
                                   name="confirm_pin" required pattern="[0-9]{4}" maxlength="4"
                                   inputmode="numeric">
                        </div>
                        <button type="submit" class="btn btn-primary w-100">
                            Update PIN
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Stats Card -->
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h3>My Stats</h3>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <div class="stat-card">
                                <i class="fas fa-coins fa-2x text-warning"></i>
                                <div class="stat-info">
                                    <h4>My Coins</h4>
                                    <p class="mb-0">{{ current_user.coins }}</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 mb-3">
                            <div class="stat-card">
                                <i class="fas fa-star fa-2x text-primary"></i>
                                <div class="stat-info">
                                    <h4>Family Points</h4>
                                    <p class="mb-0">{{ current_user.family_points }}</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 mb-3">
                            <div class="stat-card">
                                <i class="fas fa-check-circle fa-2x text-success"></i>
                                <div class="stat-info">
                                    <h4>Completed Chores</h4>
                                    <p class="mb-0">{{ completed_chores_count }}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.avatar-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
    gap: 1rem;
    margin: 1rem 0;
}

.avatar-option {
    text-align: center;
}

.avatar-radio {
    display: none;
}

.avatar-label {
    display: inline-block;
    padding: 0.5rem;
    border-radius: 50%;
    cursor: pointer;
    transition: all 0.3s ease;
}

.avatar-radio:checked + .avatar-label {
    background-color: #e3f2fd;
    transform: scale(1.1);
}

.stat-card {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem;
    background: #f8f9fa;
    border-radius: 8px;
}

.stat-info h4 {
    font-size: 1rem;
    margin: 0;
    color: #6c757d;
}

.stat-info p {
    font-size: 1.5rem;
    font-weight: bold;
}
</style>
{% endblock %} 